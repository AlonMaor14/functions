kind: remote
metadata:
  name: bert-embeddings
  tag: ''
  hash: acb7f04dc197d9535937e64d892ceb749a001027
  project: default
  labels:
    framework: pytorch
  categories:
  - NLP
  - BERT
  - embeddings
spec:
  command: ''
  args: []
  image: ''
  entry_points:
    init_context:
      name: init_context
      doc: ''
      parameters:
      - name: context
        default: ''
      outputs:
      - default: ''
      lineno: 7
    handler:
      name: handler
      doc: ''
      parameters:
      - name: context
        default: ''
      - name: event
        default: ''
      outputs:
      - default: ''
      lineno: 15
  description: Get BERT based embeddings for given text
  min_replicas: 1
  max_replicas: 4
  env: []
  base_spec:
    apiVersion: nuclio.io/v1
    kind: Function
    metadata:
      name: bert-embeddings
      labels: {}
      annotations:
        nuclio.io/generated_by: function generated from bert_embeddings.py
    spec:
      runtime: python:3.6
      handler: bert_embeddings:handler
      env: []
      volumes: []
      build:
        commands: []
        noBaseImagesPull: true
        functionSourceCode: ZnJvbSB0cmFuc2Zvcm1lcnMgaW1wb3J0IEJlcnRNb2RlbCwgQmVydFRva2VuaXplcgppbXBvcnQgdG9yY2gKZnJvbSB0eXBpbmcgaW1wb3J0IFVuaW9uLCBMaXN0CmltcG9ydCBqc29uCmltcG9ydCBwaWNrbGUKCmRlZiBpbml0X2NvbnRleHQoY29udGV4dCk6CiAgICB0b2tlbml6ZXIgPSBCZXJ0VG9rZW5pemVyLmZyb21fcHJldHJhaW5lZCgnYmVydC1iYXNlLXVuY2FzZWQnKQogICAgbW9kZWwgPSBCZXJ0TW9kZWwuZnJvbV9wcmV0cmFpbmVkKCdiZXJ0LWJhc2UtdW5jYXNlZCcpCiAgICBtb2RlbC5ldmFsKCkKICAgIAogICAgc2V0YXR0cihjb250ZXh0LnVzZXJfZGF0YSwgJ3Rva2VuaXplcicsIHRva2VuaXplcikKICAgIHNldGF0dHIoY29udGV4dC51c2VyX2RhdGEsICdtb2RlbCcsIG1vZGVsKQoKZGVmIGhhbmRsZXIoY29udGV4dCwgZXZlbnQpOgogICAgZG9jcyA9IGpzb24ubG9hZHMoZXZlbnQuYm9keSkKICAgIGRvY3MgPSBbZG9jLmxvd2VyKCkgZm9yIGRvYyBpbiBkb2NzXQogICAgZG9jcyA9IGNvbnRleHQudXNlcl9kYXRhLnRva2VuaXplci5iYXRjaF9lbmNvZGVfcGx1cyhkb2NzLCBwYWRfdG9fbWF4X2xlbmd0aD1UcnVlLCByZXR1cm5fdGVuc29ycz0ncHQnKQogICAgCiAgICB3aXRoIHRvcmNoLm5vX2dyYWQoKToKICAgICAgICBlbWJlZGRpbmdzID0gY29udGV4dC51c2VyX2RhdGEubW9kZWwoKipkb2NzKQogICAgZW1iZWRkaW5ncyA9IFtlbWJlZGRpbmdzWzBdLm51bXB5KCksIGVtYmVkZGluZ3NbMV0ubnVtcHkoKV0KICAgIHJldHVybiBwaWNrbGUuZHVtcHMoZW1iZWRkaW5ncykKCg==
  source: ''
  build:
    commands:
    - python -m pip install torch==1.6.0 transformers==3.0.1 nuclio
    code_origin: https://github.com/AlonMaor14/functions.git#ff4abf34609f7887d3717b1604aa576e677c2c5c:bert_embeddings.py
  default_handler: ''
verbose: false
